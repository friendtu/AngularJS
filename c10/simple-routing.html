<html>
<head>
    <title> AngularJS Routing</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.19/angular.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.19/angular-route.js"></script>
</head>
<body ng-app="routingApp">
    <h2>AngularJS Routing Application</h2>
    <ul>
        <li><a href='#/'>Default Route</a></li>
        <li><a href='#/second'>Second Route</a></li>
        <li><a href='#/controller'>controller example</a> </li>
        <li><a href='#/aba'>Nonexistient Route</a></li>
        <li><a href='#/redirect'>Redirect to second</a></li>
        <li><a href='#/protected'>Protected</a></li>
    </ul>
    <div ng-view></div>


    <script type="text/javascript">
        angular.module('routingApp',['ngRoute'])
            .value('Constant',{MAGIC_NUMBER:42})
            .config(['$routeProvider',function($routeProvider){
                $routeProvider.when('/',{
                    template:'<h5>This is the default route</h5>'
                })
                .when('/second',{
                    template: '<h5>This is the second route</h5>'
                })
                .when('/controller',{
                    controller: ['$window','$log','immediate',function($window,$log,immediate){
                        //$window.alert('The route has been routed.');
                        $log.log("Immediate is",immediate);
                    }]
                })
                .when('/redirect', {
                    redirectTo:'/second'
                })
                .when('/protected',{
                    template:"<h5>This is a prected page!",
                    resolve: {
                        immediate:['Constant',function(Constant){
                            return Constant.MAGIC_NUMBER*2;
                        }],
                        async:['$http',function($http){
                            return $http.get('/api/getAccess')
                        }]
                    }
                })
                .otherwise({redirectTo:'/'});
            }])
            .controller('$log','immediate',function($log,immediate){
                $log.log("Immediate is ",immediate);
            });
    </script>
</body>
</html>